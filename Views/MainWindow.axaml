<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:CheckHash.ViewModels"
        xmlns:views="using:CheckHash.Views"
        xmlns:controls="using:CheckHash.Views.Controls"
        xmlns:conv="using:CheckHash.Converters"
        xmlns:icons="clr-namespace:Material.Icons.Avalonia;assembly=Material.Icons.Avalonia"
        x:Class="CheckHash.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Icon="/Assets/icon/favicon.ico"
        Title="{Binding AppTitleText}"
        Width="1600" Height="900"
        WindowStartupLocation="CenterScreen"
        Background="{DynamicResource AppBackgroundBrush}"
        SystemDecorations="Full"
        ExtendClientAreaToDecorationsHint="True"
        ExtendClientAreaChromeHints="PreferSystemChrome"
        CanResize="True"
        FontFamily="{Binding SettingsVM.Font.SelectedFont}"
        FontSize="{Binding SettingsVM.Font.BaseFontSize}"
        FlowDirection="{Binding L.FlowDirection}">

    <Window.Resources>
        <conv:HashMaskConverter x:Key="HashMaskConverter" />
        <conv:CountToVisibilityConverter x:Key="CountToVisibilityConverter" />
        <conv:ComputeButtonEnabledConverter x:Key="ComputeButtonEnabledConverter" />
        <conv:AlgorithmEnabledConverter x:Key="AlgorithmEnabledConverter" />
        <conv:FileStatusConverter x:Key="FileStatusConverter" />
        <conv:FileSizeFilterConverter x:Key="FileSizeFilterConverter" />

    </Window.Resources>

    <!-- Key Bindings -->
    <Window.KeyBindings>
        <KeyBinding Gesture="Shift+A" Command="{Binding HotkeyCheckAllCommand}" />
        <KeyBinding Gesture="Shift+C" Command="{Binding HotkeyCreateAllCommand}" />
        <KeyBinding Gesture="Ctrl+F" Command="{Binding OpenFilePickerCommand}" />
        <KeyBinding Gesture="Meta+F" Command="{Binding OpenFilePickerCommand}" />
        <KeyBinding Gesture="Shift+Z" Command="{Binding HotkeyCompressAllCommand}" />
        <KeyBinding Gesture="Ctrl+Shift+H" Command="{Binding ClearAllListsCommand}" />
        <KeyBinding Gesture="Meta+Shift+H" Command="{Binding ClearAllListsCommand}" />
    </Window.KeyBindings>

    <Window.Styles>
        <Style Selector="StackPanel.DragOver">
            <Setter Property="Background">
                <SolidColorBrush Color="{DynamicResource SystemAccentColor}" Opacity="0.2" />
            </Setter>
            <Setter Property="Opacity" Value="1.0" />
        </Style>

        <Style Selector="ListBox.DragOver">
            <Setter Property="Background">
                <SolidColorBrush Color="{DynamicResource SystemAccentColor}" Opacity="0.2" />
            </Setter>
        </Style>

        <Style Selector="TextBox.DragOver">
            <Setter Property="Background">
                <SolidColorBrush Color="{DynamicResource SystemAccentColor}" Opacity="0.2" />
            </Setter>
        </Style>

        <Style Selector="Button.MenuBtn">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Height" Value="50" />
            <Setter Property="Padding" Value="0" />
            <Setter Property="HorizontalAlignment" Value="Stretch" />
            <Setter Property="CornerRadius" Value="8" />
            <Setter Property="Margin" Value="5,2" />
            <Setter Property="Transitions">
                <Transitions>
                    <BrushTransition Property="Background" Duration="0:0:0.2" />
                    <TransformOperationsTransition Property="RenderTransform" Duration="0:0:0.1" />
                </Transitions>
            </Setter>
        </Style>

        <Style Selector="Button.MenuBtn:pointerover">
            <Setter Property="Background" Value="{DynamicResource SystemAccentColorLight}" />
            <Setter Property="RenderTransform" Value="scale(1.02)" />
        </Style>

        <Style Selector="Button.MenuBtn:pressed">
            <Setter Property="RenderTransform" Value="scale(0.98)" />
        </Style>

        <Style Selector="Button.MenuBtn icons|MaterialIcon">
            <Setter Property="Transitions">
                <Transitions>
                    <BrushTransition Property="Foreground" Duration="0:0:0.2" />
                </Transitions>
            </Setter>
        </Style>

        <Style Selector="SplitView[IsPaneOpen=False] Button.MenuBtn:pointerover icons|MaterialIcon">
            <Setter Property="Foreground" Value="{DynamicResource SystemAccentColor}" />
        </Style>

        <Style Selector="SplitView[IsPaneOpen=True] Button.MenuBtn:pointerover icons|MaterialIcon">
            <Setter Property="Foreground" Value="{DynamicResource SystemAccentColor}" />
        </Style>
        <Style Selector="SplitView[IsPaneOpen=True] Button.MenuBtn:pointerover TextBlock">
            <Setter Property="Foreground" Value="{DynamicResource SystemAccentColor}" />
        </Style>
    </Window.Styles>

    <Window.DataTemplates>
        <DataTemplate DataType="vm:SettingsViewModel">
            <views:SettingsView />
        </DataTemplate>
        <DataTemplate DataType="vm:AboutViewModel">
            <views:AboutView />
        </DataTemplate>
        <DataTemplate DataType="vm:DeveloperViewModel">
            <views:DeveloperView />
        </DataTemplate>
        <DataTemplate DataType="vm:CreateHashViewModel">
            <Grid RowDefinitions="Auto, Auto, Auto, *">
                <Grid ColumnDefinitions="*, Auto">
                    <StackPanel Orientation="Vertical">
                        <TextBlock Text="{Binding Localization[Title_CreateHash]}" FontSize="24" FontWeight="Bold"
                                   Margin="0,0,0,5" />
                        <!-- Help Text -->
                        <TextBlock Text="{Binding Localization[Help_CreateHash]}" FontSize="12" Opacity="0.6"
                                   FontStyle="Italic" Margin="0,0,0,15" />
                    </StackPanel>

                    <StackPanel Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Right" Spacing="5">
                        <TextBlock Text="{Binding TotalFilesText}" Opacity="0.7" IsVisible="{Binding !IsComputing}"
                                   HorizontalAlignment="Right" />

                        <StackPanel IsVisible="{Binding IsComputing}" Orientation="Vertical"
                                    HorizontalAlignment="Right">
                            <TextBlock Text="{Binding ProgressStatsText}" FontWeight="Bold" HorizontalAlignment="Right" />
                            <TextBlock Text="{Binding DetailedStatsText}" FontSize="11" Opacity="0.8"
                                       HorizontalAlignment="Right" />
                            <TextBlock Text="{Binding SpeedText}" Foreground="{DynamicResource SystemAccentColor}"
                                       FontWeight="Bold" HorizontalAlignment="Right"
                                       IsVisible="{Binding $parent[Window].((vm:MainWindowViewModel)DataContext).SettingsVM.ShowReadWriteSpeed}" />
                        </StackPanel>
                    </StackPanel>
                </Grid>

                <StackPanel Grid.Row="1" Orientation="Horizontal" Spacing="10" Margin="0,0,0,15">
                    <StackPanel Orientation="Horizontal" Spacing="10" IsEnabled="{Binding !IsComputing}">
                        <Button Content="{Binding Localization[Btn_AddFiles]}" Command="{Binding AddFilesCommand}"
                                CommandParameter="{Binding $parent[Window]}"
                                ToolTip.Tip="Ctrl+F / Cmd+F" />
                        <Button Content="{Binding Localization[Btn_AddFolder]}" Command="{Binding AddFolderCommand}"
                                CommandParameter="{Binding $parent[Window]}" />
                        <Button Content="{Binding Localization[Btn_Clear]}" Command="{Binding ClearListCommand}"
                                ToolTip.Tip="Ctrl+Shift+H" />
                        <Button Content="{Binding Localization[Btn_ClearHashes]}"
                                Command="{Binding ClearAllHashesCommand}"
                                IsVisible="{Binding Files.Count}" />
                        <Button Content="{Binding Localization[Btn_ClearFailed]}"
                                Command="{Binding ClearFailedCommand}"
                                IsVisible="{Binding Files.Count}" />
                        <Button Content="{Binding Localization[Btn_Compress]}"
                                Command="{Binding CompressFilesCommand}"
                                CommandParameter="{Binding $parent[Window]}"
                                IsEnabled="{Binding Files.Count}"
                                ToolTip.Tip="Shift+Z" />
                    </StackPanel>

                    <Panel>
                        <Button Content="{Binding Localization[Btn_CalcAll]}"
                                Background="{DynamicResource SystemAccentColor}" Foreground="White"
                                Command="{Binding ComputeAllCommand}"
                                IsVisible="{Binding !IsComputing}"
                                ToolTip.Tip="Shift+C" />
                        <Button Content="{Binding Localization[Btn_Cancel]}"
                                Background="#FF6060" Foreground="White"
                                Command="{Binding CancelAllCommand}"
                                IsVisible="{Binding IsComputing}"
                                ToolTip.Tip="Esc" />
                    </Panel>

                    <TextBlock Text="{Binding RemainingTime}" VerticalAlignment="Center" Margin="10,0,0,0"
                               IsVisible="{Binding IsComputing}" FontWeight="SemiBold" />
                </StackPanel>

                <StackPanel Grid.Row="2" Orientation="Horizontal" Spacing="10" Margin="0,0,0,10"
                            IsVisible="{Binding HasFiles}" IsEnabled="{Binding !IsComputing}">
                    <TextBox Text="{Binding SearchText, Mode=TwoWay}" Watermark="Search by name..." Width="400"
                             Classes="DragOver" BorderThickness="0,0,0,1" CornerRadius="0" />
                    <ComboBox ItemsSource="{Binding FilterStatusOptions}"
                              SelectedItem="{Binding SelectedFilterStatus, Mode=TwoWay}"
                              Width="150">
                        <ComboBox.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Converter={StaticResource FileStatusConverter}}" />
                            </DataTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>

                    <ComboBox ItemsSource="{Binding SizeFilterOptions}"
                              SelectedItem="{Binding SelectedSizeFilter, Mode=TwoWay}"
                              Width="180" PlaceholderText="Size">
                        <ComboBox.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Converter={StaticResource FileSizeFilterConverter}}" />
                            </DataTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>
                </StackPanel>

                <ProgressBar Grid.Row="3" Minimum="0" Maximum="{Binding ProgressMax}" Value="{Binding ProgressValue}"
                             IsVisible="{Binding IsComputing}" Height="4" Margin="0,0,0,10" VerticalAlignment="Top" />

                <StackPanel Grid.Row="3" HorizontalAlignment="Center" VerticalAlignment="Center"
                            IsVisible="{Binding Files.Count, Converter={StaticResource CountToVisibilityConverter}}"
                            Opacity="0.5" Spacing="10"
                            DragDrop.AllowDrop="True" DragDrop.Drop="OnMainDrop"
                            DragDrop.DragEnter="OnDragEnter" DragDrop.DragLeave="OnDragLeave"
                            Background="Transparent">
                    <icons:MaterialIcon Kind="FilePlusOutline" Width="64" Height="64" />
                    <TextBlock Text="{Binding Localization[EmptyState_DropFiles]}"
                               FontSize="16" HorizontalAlignment="Center" />
                </StackPanel>

                <ListBox Grid.Row="3" ItemsSource="{Binding Files}" Background="Transparent"
                         IsVisible="{Binding Files.Count}"
                         DragDrop.AllowDrop="True" DragDrop.Drop="OnMainDrop"
                         DragDrop.DragEnter="OnDragEnter" DragDrop.DragLeave="OnDragLeave">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <Border BorderBrush="#30808080" BorderThickness="0,0,0,1" Padding="5">
                                <Grid ColumnDefinitions="400, 90, 110, *, 40, 80, 100">

                                    <!-- 0: File Name -->
                                    <StackPanel Grid.Column="0" VerticalAlignment="Center" Margin="0,0,10,0"
                                                ToolTip.Tip="{Binding FilePath}">
                                        <controls:HighlightTextBlock Text="{Binding FileName}"
                                                                     HighlightText="{Binding $parent[ListBox].((vm:CreateHashViewModel)DataContext).SearchText}"
                                                                     HighlightBrush="{DynamicResource SystemAccentColor}"
                                                                     TextTrimming="CharacterEllipsis"
                                                                     FontWeight="Bold" />
                                        <TextBlock Text="{Binding FilePath}" FontSize="10" Opacity="0.6"
                                                   TextTrimming="CharacterEllipsis" />
                                    </StackPanel>

                                    <!-- 1: Size & Duration -->
                                    <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="0,0,10,0">
                                        <TextBlock Text="{Binding FileSize}" FontSize="11" Foreground="Gray" />
                                        <TextBlock Text="{Binding ProcessDuration}" FontSize="11"
                                                   Foreground="LimeGreen" FontWeight="Bold"
                                                   IsVisible="{Binding ProcessDuration, Converter={x:Static StringConverters.IsNotNullOrEmpty}}" />
                                    </StackPanel>

                                    <!-- 2: Algorithm -->
                                    <ComboBox Grid.Column="2"
                                              ItemsSource="{Binding $parent[ListBox].((vm:CreateHashViewModel)DataContext).AlgorithmList}"
                                              SelectedItem="{Binding SelectedAlgorithm}"
                                              VerticalAlignment="Center" Margin="0,0,5,0" Width="110">
                                        <ComboBox.IsEnabled>
                                            <MultiBinding Converter="{StaticResource AlgorithmEnabledConverter}">
                                                <Binding Path="ProcessingState" />
                                                <Binding Path="$parent[ListBox].((vm:CreateHashViewModel)DataContext).IsComputing" />
                                            </MultiBinding>
                                        </ComboBox.IsEnabled>
                                    </ComboBox>

                                    <!-- 3: Hash Result (Eye to Hide/Reveal) -->
                                    <Grid Grid.Column="3" ColumnDefinitions="*, Auto">
                                        <TextBox Grid.Column="0"
                                                 IsReadOnly="True" VerticalAlignment="Center"
                                                 FontSize="11" FontFamily="Consolas, Monospace"
                                                 BorderThickness="0" Background="Transparent"
                                                 TextWrapping="NoWrap">
                                            <TextBox.Text>
                                                <MultiBinding Converter="{StaticResource HashMaskConverter}">
                                                    <Binding Path="ResultHash" />
                                                    <Binding
                                                        Path="$parent[Window].((vm:MainWindowViewModel)DataContext).Prefs.IsHashMaskingEnabled" />
                                                    <Binding Path="IsRevealed" />
                                                </MultiBinding>
                                            </TextBox.Text>
                                        </TextBox>

                                        <ToggleButton Grid.Column="1"
                                                      IsChecked="{Binding IsRevealed}"
                                                      Background="Transparent" Padding="4" Margin="2,0,0,0"
                                                      IsVisible="{Binding $parent[Window].((vm:MainWindowViewModel)DataContext).Prefs.IsHashMaskingEnabled}"
                                                      AutomationProperties.Name="{Binding $parent[ListBox].((vm:CreateHashViewModel)DataContext).Localization[Tip_HashVisibility]}">
                                            <ToolTip.Tip>
                                                <Panel>
                                                    <TextBlock
                                                        Text="{Binding $parent[ListBox].((vm:CreateHashViewModel)DataContext).Localization[Tip_ShowHash]}"
                                                        IsVisible="{Binding !IsRevealed}" />
                                                    <TextBlock
                                                        Text="{Binding $parent[ListBox].((vm:CreateHashViewModel)DataContext).Localization[Tip_HideHash]}"
                                                        IsVisible="{Binding IsRevealed}" />
                                                </Panel>
                                            </ToolTip.Tip>
                                            <Panel>
                                                <icons:MaterialIcon Kind="EyeOutline" Width="16" Height="16"
                                                                    IsVisible="{Binding !IsRevealed}" />
                                                <icons:MaterialIcon Kind="EyeOffOutline" Width="16" Height="16"
                                                                    IsVisible="{Binding IsRevealed}" />
                                            </Panel>
                                        </ToggleButton>
                                    </Grid>

                                    <!-- 4: Copy Button -->
                                    <Button Grid.Column="4" Padding="5" Background="Transparent" BorderThickness="0"
                                            Command="{Binding $parent[ListBox].((vm:CreateHashViewModel)DataContext).CopyToClipboardCommand}"
                                            CommandParameter="{Binding ResultHash}"
                                            ToolTip.Tip="{Binding $parent[ListBox].((vm:CreateHashViewModel)DataContext).Localization[Tip_CopyHash]}"
                                            AutomationProperties.Name="{Binding $parent[ListBox].((vm:CreateHashViewModel)DataContext).Localization[Tip_CopyHash]}"
                                            IsVisible="{Binding ResultHash, Converter={x:Static StringConverters.IsNotNullOrEmpty}}">
                                        <icons:MaterialIcon Kind="ContentCopy" Width="16" Height="16" />
                                    </Button>

                                    <!-- 5: Status -->
                                    <TextBlock Grid.Column="5" Text="{Binding Status}"
                                               VerticalAlignment="Center" Foreground="#00bfff" FontSize="12"
                                               TextWrapping="Wrap" />

                                    <!-- 6: Actions -->
                                    <StackPanel Grid.Column="6" Orientation="Horizontal" Spacing="2"
                                                HorizontalAlignment="Right">
                                        <Button Padding="5"
                                                ToolTip.Tip="{Binding $parent[ListBox].((vm:CreateHashViewModel)DataContext).Localization[Dialog_SaveHash]}"
                                                AutomationProperties.Name="{Binding $parent[ListBox].((vm:CreateHashViewModel)DataContext).Localization[Dialog_SaveHash]}"
                                                Background="Transparent"
                                                Command="{Binding $parent[ListBox].((vm:CreateHashViewModel)DataContext).SaveHashFileCommand}"
                                                CommandParameter="{Binding .}">
                                            <icons:MaterialIcon Kind="ContentSave" Width="18" Height="18" />
                                        </Button>

                                        <Button Padding="5" Background="Transparent"
                                                Command="{Binding $parent[ListBox].((vm:CreateHashViewModel)DataContext).ComputeSingleCommand}"
                                                CommandParameter="{Binding .}"
                                                AutomationProperties.Name="Compute or Stop">
                                            <Button.IsEnabled>
                                                <MultiBinding
                                                    Converter="{StaticResource ComputeButtonEnabledConverter}">
                                                    <Binding Path="IsCancelled" />
                                                    <Binding Path="IsProcessing" />
                                                    <Binding
                                                        Path="$parent[ListBox].((vm:CreateHashViewModel)DataContext).IsComputing" />
                                                </MultiBinding>
                                            </Button.IsEnabled>
                                            <ToolTip.Tip>
                                                <Panel>
                                                    <TextBlock
                                                        Text="{Binding $parent[ListBox].((vm:CreateHashViewModel)DataContext).Localization[Tip_Compute]}"
                                                        IsVisible="{Binding !IsProcessing}" />
                                                    <TextBlock
                                                        Text="{Binding $parent[ListBox].((vm:CreateHashViewModel)DataContext).Localization[Tip_Stop]}"
                                                        IsVisible="{Binding IsProcessing}" />
                                                </Panel>
                                            </ToolTip.Tip>
                                            <Panel>
                                                <icons:MaterialIcon Kind="PlayCircleOutline" Width="18" Height="18"
                                                                    Foreground="LimeGreen"
                                                                    IsVisible="{Binding !IsProcessing}" />
                                                <icons:MaterialIcon Kind="StopCircleOutline" Width="18" Height="18"
                                                                    Foreground="Orange"
                                                                    IsVisible="{Binding IsProcessing}" />
                                            </Panel>
                                        </Button>

                                        <Button Padding="5"
                                                ToolTip.Tip="{Binding $parent[ListBox].((vm:CreateHashViewModel)DataContext).Localization[Tip_ClearHash]}"
                                                AutomationProperties.Name="{Binding $parent[ListBox].((vm:CreateHashViewModel)DataContext).Localization[Tip_ClearHash]}"
                                                Background="Transparent"
                                                Command="{Binding $parent[ListBox].((vm:CreateHashViewModel)DataContext).ClearHashCommand}"
                                                CommandParameter="{Binding .}">
                                            <icons:MaterialIcon Kind="Eraser" Width="18" Height="18"
                                                                Foreground="#FFD700" />
                                        </Button>

                                        <Button Padding="5"
                                                ToolTip.Tip="{Binding $parent[ListBox].((vm:CreateHashViewModel)DataContext).Localization[Tip_RemoveFile]}"
                                                AutomationProperties.Name="{Binding $parent[ListBox].((vm:CreateHashViewModel)DataContext).Localization[Tip_RemoveFile]}"
                                                Background="Transparent"
                                                Command="{Binding $parent[ListBox].((vm:CreateHashViewModel)DataContext).RemoveFileCommand}"
                                                CommandParameter="{Binding .}">
                                            <icons:MaterialIcon Kind="TrashCanOutline" Width="18" Height="18"
                                                                Foreground="#FF6060" />
                                        </Button>
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </Grid>
        </DataTemplate>

        <DataTemplate DataType="vm:CheckHashViewModel">
            <Grid RowDefinitions="Auto, Auto, Auto, Auto, *">
                <Grid ColumnDefinitions="*, Auto">
                    <StackPanel Orientation="Vertical">
                        <TextBlock Text="{Binding Localization[Title_CheckHash]}" FontSize="24" FontWeight="Bold"
                                   Margin="0,0,0,5" />
                        <!-- Help Text -->
                        <TextBlock Text="{Binding Localization[Help_CheckHash]}" FontSize="12" Opacity="0.6"
                                   FontStyle="Italic" Margin="0,0,0,15" />
                    </StackPanel>

                    <StackPanel Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Right" Spacing="5">
                        <TextBlock Text="{Binding TotalFilesText}" Opacity="0.7" IsVisible="{Binding !IsChecking}"
                                   HorizontalAlignment="Right" />

                        <StackPanel IsVisible="{Binding IsChecking}" Orientation="Vertical" HorizontalAlignment="Right">
                            <TextBlock Text="{Binding ProgressStatsText}" FontWeight="Bold" HorizontalAlignment="Right" />
                            <TextBlock Text="{Binding DetailedStatsText}" FontSize="11" Opacity="0.8"
                                       HorizontalAlignment="Right" />
                            <TextBlock Text="{Binding SpeedText}" Foreground="{DynamicResource SystemAccentColor}"
                                       FontWeight="Bold" HorizontalAlignment="Right"
                                       IsVisible="{Binding $parent[Window].((vm:MainWindowViewModel)DataContext).SettingsVM.ShowReadWriteSpeed}" />
                        </StackPanel>
                    </StackPanel>
                </Grid>

                <StackPanel Grid.Row="1" Orientation="Horizontal" Spacing="10" Margin="0,0,0,10">
                    <StackPanel Orientation="Horizontal" Spacing="10" IsEnabled="{Binding !IsChecking}">
                        <Button Content="{Binding Localization[Btn_AddFiles]}"
                                Command="{Binding AddFilesCommand}"
                                CommandParameter="{Binding $parent[Window]}"
                                ToolTip.Tip="Ctrl+F / Cmd+F" />
                        <Button Content="{Binding Localization[Btn_AddFolder]}" Command="{Binding AddFolderCommand}"
                                CommandParameter="{Binding $parent[Window]}" />
                        <Button Content="{Binding Localization[Btn_Clear]}" Command="{Binding ClearListCommand}"
                                ToolTip.Tip="Ctrl+Shift+H" />
                        <Button Content="{Binding Localization[Btn_ClearHashes]}"
                                Command="{Binding ClearAllHashesCommand}"
                                IsVisible="{Binding Files.Count}" />
                        <Button Content="{Binding Localization[Btn_ClearFailed]}"
                                Command="{Binding ClearFailedCommand}"
                                IsVisible="{Binding Files.Count}" />

                        <TextBlock Text="{Binding Localization[Lbl_Sample]}" VerticalAlignment="Center" />
                        <ComboBox ItemsSource="{Binding AlgorithmList}" SelectedItem="{Binding GlobalAlgorithm}"
                                  Width="150" VerticalAlignment="Center" />
                    </StackPanel>

                    <Panel>
                        <Button Content="{Binding Localization[Btn_CheckAll]}"
                                Background="{DynamicResource SystemAccentColor}" Foreground="White"
                                Command="{Binding VerifyAllCommand}"
                                IsVisible="{Binding !IsChecking}"
                                ToolTip.Tip="Shift+A" />
                        <Button Content="{Binding Localization[Btn_Cancel]}"
                                Background="#FF6060" Foreground="White"
                                Command="{Binding CancelAllCommand}"
                                IsVisible="{Binding IsChecking}"
                                ToolTip.Tip="Esc" />
                    </Panel>

                    <TextBlock Text="{Binding RemainingTime}" VerticalAlignment="Center" Margin="10,0,0,0"
                               IsVisible="{Binding IsChecking}" FontWeight="SemiBold" />
                </StackPanel>

                <StackPanel Grid.Row="2" Orientation="Horizontal" Spacing="10" Margin="0,0,0,10"
                            IsVisible="{Binding HasFiles}" IsEnabled="{Binding !IsChecking}">
                    <TextBox Text="{Binding SearchText, Mode=TwoWay}" Watermark="Search by name..." Width="400"
                             Classes="DragOver" BorderThickness="0,0,0,1" CornerRadius="0" />
                    <ComboBox ItemsSource="{Binding FilterStatusOptions}"
                              SelectedItem="{Binding SelectedFilterStatus, Mode=TwoWay}"
                              Width="150">
                        <ComboBox.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Converter={StaticResource FileStatusConverter}}" />
                            </DataTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>

                    <ComboBox ItemsSource="{Binding SizeFilterOptions}"
                              SelectedItem="{Binding SelectedSizeFilter, Mode=TwoWay}"
                              Width="180" PlaceholderText="Size">
                        <ComboBox.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Converter={StaticResource FileSizeFilterConverter}}" />
                            </DataTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>
                </StackPanel>

                <ProgressBar Grid.Row="3" Minimum="0" Maximum="{Binding ProgressMax}" Value="{Binding ProgressValue}"
                             IsVisible="{Binding IsChecking}" Height="4" Margin="0,0,0,10" />

                <StackPanel Grid.Row="4" HorizontalAlignment="Center" VerticalAlignment="Center"
                            IsVisible="{Binding Files.Count, Converter={StaticResource CountToVisibilityConverter}}"
                            Opacity="0.5" Spacing="10"
                            DragDrop.AllowDrop="True" DragDrop.Drop="OnMainDrop"
                            DragDrop.DragEnter="OnDragEnter" DragDrop.DragLeave="OnDragLeave"
                            Background="Transparent">
                    <icons:MaterialIcon Kind="FilePlusOutline" Width="64" Height="64" />
                    <TextBlock Text="{Binding Localization[EmptyState_DropFiles]}"
                               FontSize="16" HorizontalAlignment="Center" />
                </StackPanel>

                <ListBox Grid.Row="4" ItemsSource="{Binding Files}" Background="Transparent"
                         IsVisible="{Binding Files.Count}"
                         DragDrop.AllowDrop="True" DragDrop.Drop="OnMainDrop"
                         DragDrop.DragEnter="OnDragEnter" DragDrop.DragLeave="OnDragLeave">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <Border BorderBrush="#30808080" BorderThickness="0,0,0,1" Padding="5">
                                <Grid ColumnDefinitions="400, 100, *, 100, 80">

                                    <StackPanel Grid.Column="0" VerticalAlignment="Center" Margin="0,0,10,0"
                                                ToolTip.Tip="{Binding FilePath}">
                                        <controls:HighlightTextBlock Text="{Binding FileName}"
                                                                     HighlightText="{Binding $parent[ListBox].((vm:CheckHashViewModel)DataContext).SearchText}"
                                                                     HighlightBrush="{DynamicResource SystemAccentColor}"
                                                                     TextTrimming="CharacterEllipsis"
                                                                     FontWeight="Bold" />
                                        <TextBlock Text="{Binding FilePath}" FontSize="10" Opacity="0.6"
                                                   TextTrimming="CharacterEllipsis" />
                                    </StackPanel>

                                    <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="0,0,10,0">
                                        <TextBlock Text="{Binding FileSize}" FontSize="11" Foreground="Gray" />
                                        <TextBlock Text="{Binding ProcessDuration}" FontSize="11"
                                                   Foreground="LimeGreen" FontWeight="Bold"
                                                   IsVisible="{Binding ProcessDuration, Converter={x:Static StringConverters.IsNotNullOrEmpty}}" />
                                    </StackPanel>

                                    <!-- Hash Input/Display -->
                                    <Grid Grid.Column="2" ColumnDefinitions="*, Auto, Auto" Margin="0,0,10,0">
                                        <Panel Grid.Column="0">
                                            <TextBlock VerticalAlignment="Center" FontFamily="Consolas, Monospace"
                                                       FontSize="11"
                                                       Margin="5,0">
                                                <TextBlock.Text>
                                                    <MultiBinding Converter="{StaticResource HashMaskConverter}">
                                                        <Binding Path="ExpectedHash" />
                                                        <Binding
                                                            Path="$parent[Window].((vm:MainWindowViewModel)DataContext).Prefs.IsHashMaskingEnabled" />
                                                        <Binding Path="IsRevealed" />
                                                    </MultiBinding>
                                                </TextBlock.Text>
                                                <TextBlock.IsVisible>
                                                    <MultiBinding Converter="{x:Static BoolConverters.And}">
                                                        <Binding
                                                            Path="$parent[Window].((vm:MainWindowViewModel)DataContext).Prefs.IsHashMaskingEnabled" />
                                                        <Binding Path="!IsRevealed" />
                                                    </MultiBinding>
                                                </TextBlock.IsVisible>
                                            </TextBlock>

                                            <!-- TextBox Real (Mask OFF/ Revealed) -->
                                            <TextBox Name="HashInputBox"
                                                     Text="{Binding ExpectedHash, Mode=TwoWay}"
                                                     Watermark="{Binding $parent[ListBox].((vm:CheckHashViewModel)DataContext).Localization[Watermark_PasteDrop]}"
                                                     VerticalAlignment="Center" FontFamily="Consolas, Monospace"
                                                     FontSize="11"
                                                     DragDrop.AllowDrop="True" DragDrop.Drop="OnHashFileDrop"
                                                     DragDrop.DragEnter="OnDragEnter" DragDrop.DragLeave="OnDragLeave">
                                                <TextBox.IsVisible>
                                                    <MultiBinding Converter="{x:Static BoolConverters.Or}">
                                                        <Binding
                                                            Path="!$parent[Window].((vm:MainWindowViewModel)DataContext).Prefs.IsHashMaskingEnabled" />
                                                        <Binding Path="IsRevealed" />
                                                    </MultiBinding>
                                                </TextBox.IsVisible>
                                            </TextBox>
                                        </Panel>

                                        <ToggleButton Grid.Column="1"
                                                      IsChecked="{Binding IsRevealed}"
                                                      Background="Transparent" Padding="4" Margin="2,0,0,0"
                                                      IsVisible="{Binding $parent[Window].((vm:MainWindowViewModel)DataContext).Prefs.IsHashMaskingEnabled}"
                                                      AutomationProperties.Name="{Binding $parent[ListBox].((vm:CheckHashViewModel)DataContext).Localization[Tip_HashVisibility]}">
                                            <ToolTip.Tip>
                                                <Panel>
                                                    <TextBlock
                                                        Text="{Binding $parent[ListBox].((vm:CheckHashViewModel)DataContext).Localization[Tip_ShowHash]}"
                                                        IsVisible="{Binding !IsRevealed}" />
                                                    <TextBlock
                                                        Text="{Binding $parent[ListBox].((vm:CheckHashViewModel)DataContext).Localization[Tip_HideHash]}"
                                                        IsVisible="{Binding IsRevealed}" />
                                                </Panel>
                                            </ToolTip.Tip>
                                            <Panel>
                                                <icons:MaterialIcon Kind="EyeOutline" Width="16" Height="16"
                                                                    IsVisible="{Binding !IsRevealed}" />
                                                <icons:MaterialIcon Kind="EyeOffOutline" Width="16" Height="16"
                                                                    IsVisible="{Binding IsRevealed}" />
                                            </Panel>
                                        </ToggleButton>

                                        <Button Grid.Column="2" Margin="2,0,0,0" Padding="5" Background="Transparent"
                                                Command="{Binding $parent[ListBox].((vm:CheckHashViewModel)DataContext).BrowseHashFileCommand}"
                                                CommandParameter="{Binding .}"
                                                ToolTip.Tip="{Binding $parent[ListBox].((vm:CheckHashViewModel)DataContext).Localization[Tip_BrowseHash]}"
                                                AutomationProperties.Name="{Binding $parent[ListBox].((vm:CheckHashViewModel)DataContext).Localization[Tip_BrowseHash]}">
                                            <icons:MaterialIcon Kind="FileFind" Width="18" Height="18"
                                                                Foreground="#00bfff" />
                                        </Button>
                                    </Grid>

                                    <TextBlock Grid.Column="3" Text="{Binding Status}"
                                               FontWeight="Bold" VerticalAlignment="Center" TextWrapping="Wrap"
                                               FontSize="12" />

                                    <StackPanel Grid.Column="4" Orientation="Horizontal" Spacing="5"
                                                HorizontalAlignment="Right">
                                        <Button Padding="5" Background="Transparent"
                                                Command="{Binding $parent[ListBox].((vm:CheckHashViewModel)DataContext).VerifySingleCommand}"
                                                CommandParameter="{Binding .}"
                                                AutomationProperties.Name="Verify or Stop">
                                            <Button.IsEnabled>
                                                <MultiBinding
                                                    Converter="{StaticResource ComputeButtonEnabledConverter}">
                                                    <Binding Path="IsCancelled" />
                                                    <Binding Path="IsProcessing" />
                                                    <Binding
                                                        Path="$parent[ListBox].((vm:CheckHashViewModel)DataContext).IsChecking" />
                                                </MultiBinding>
                                            </Button.IsEnabled>
                                            <ToolTip.Tip>
                                                <Panel>
                                                    <TextBlock
                                                        Text="{Binding $parent[ListBox].((vm:CheckHashViewModel)DataContext).Localization[Tip_Verify]}"
                                                        IsVisible="{Binding !IsProcessing}" />
                                                    <TextBlock
                                                        Text="{Binding $parent[ListBox].((vm:CheckHashViewModel)DataContext).Localization[Tip_Stop]}"
                                                        IsVisible="{Binding IsProcessing}" />
                                                </Panel>
                                            </ToolTip.Tip>
                                            <Panel>
                                                <icons:MaterialIcon Kind="PlayCircleOutline" Width="18" Height="18"
                                                                    Foreground="LimeGreen"
                                                                    IsVisible="{Binding !IsProcessing}" />
                                                <icons:MaterialIcon Kind="StopCircleOutline" Width="18" Height="18"
                                                                    Foreground="Orange"
                                                                    IsVisible="{Binding IsProcessing}" />
                                            </Panel>
                                        </Button>

                                        <Button Padding="5"
                                                ToolTip.Tip="{Binding $parent[ListBox].((vm:CheckHashViewModel)DataContext).Localization[Tip_ClearHash]}"
                                                AutomationProperties.Name="{Binding $parent[ListBox].((vm:CheckHashViewModel)DataContext).Localization[Tip_ClearHash]}"
                                                Background="Transparent"
                                                Command="{Binding $parent[ListBox].((vm:CheckHashViewModel)DataContext).ClearHashCommand}"
                                                CommandParameter="{Binding .}">
                                            <icons:MaterialIcon Kind="Eraser" Width="18" Height="18"
                                                                Foreground="#FFD700" />
                                        </Button>

                                        <Button Padding="5"
                                                ToolTip.Tip="{Binding $parent[ListBox].((vm:CheckHashViewModel)DataContext).Localization[Tip_RemoveFile]}"
                                                AutomationProperties.Name="{Binding $parent[ListBox].((vm:CheckHashViewModel)DataContext).Localization[Tip_RemoveFile]}"
                                                Background="Transparent"
                                                Command="{Binding $parent[ListBox].((vm:CheckHashViewModel)DataContext).RemoveFileCommand}"
                                                CommandParameter="{Binding .}">
                                            <icons:MaterialIcon Kind="TrashCanOutline" Width="18" Height="18"
                                                                Foreground="#FF6060" />
                                        </Button>
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </Grid>
        </DataTemplate>
        <DataTemplate DataType="vm:UpdateViewModel">
            <views:UpdateView />
        </DataTemplate>
    </Window.DataTemplates>

    <LayoutTransformControl>
        <LayoutTransformControl.LayoutTransform>
            <ScaleTransform ScaleX="{Binding SettingsVM.Font.UiScale}"
                            ScaleY="{Binding SettingsVM.Font.UiScale}" />
        </LayoutTransformControl.LayoutTransform>

        <SplitView IsPaneOpen="{Binding IsPaneOpen}"
                   DisplayMode="Inline"
                   OpenPaneLength="265"
                   PaneBackground="Transparent">

            <SplitView.Pane>
                <Border Background="{DynamicResource PaneBackgroundBrush}"
                        CornerRadius="12"
                        Margin="15,40, 15,25"
                        BorderBrush="{DynamicResource GlassBorderBrush}"
                        BorderThickness="1">
                    <Grid RowDefinitions="Auto, *, Auto" Margin="0,10">
                        <!-- Logo / App Name -->
                        <StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="10" Margin="20,10,0,20">
                            <Image Source="/Assets/logo_in_app.png" Width="32" Height="32" VerticalAlignment="Center" />
                            <TextBlock Text="{Binding AppTitleText}" FontSize="20" FontWeight="Bold"
                                       VerticalAlignment="Center" />
                        </StackPanel>

                        <ScrollViewer Grid.Row="1">
                            <StackPanel Spacing="5">
                                <Button Command="{Binding NavigateToCreateCommand}" Classes="MenuBtn"
                                        IsEnabled="{Binding IsIdle}">
                                    <Grid ColumnDefinitions="60, *">
                                        <icons:MaterialIcon Grid.Column="0" Kind="FilePlus" Width="24" Height="24"
                                                            HorizontalAlignment="Center" />
                                        <TextBlock Grid.Column="1" Text="{Binding MenuCreateText}"
                                                   VerticalAlignment="Center"
                                                   FontWeight="SemiBold" />
                                    </Grid>
                                </Button>

                                <Button Command="{Binding NavigateToCheckCommand}" Classes="MenuBtn"
                                        IsEnabled="{Binding IsIdle}">
                                    <Grid ColumnDefinitions="60, *">
                                        <icons:MaterialIcon Grid.Column="0" Kind="FileCheck" Width="24" Height="24"
                                                            HorizontalAlignment="Center" />
                                        <TextBlock Grid.Column="1" Text="{Binding MenuCheckText}"
                                                   VerticalAlignment="Center"
                                                   FontWeight="SemiBold" />
                                    </Grid>
                                </Button>

                                <Button Command="{Binding NavigateToSettingsCommand}" Classes="MenuBtn"
                                        IsEnabled="{Binding IsIdle}">
                                    <Grid ColumnDefinitions="60, *">
                                        <icons:MaterialIcon Grid.Column="0" Kind="Cog" Width="24" Height="24"
                                                            HorizontalAlignment="Center" />
                                        <TextBlock Grid.Column="1" Text="{Binding MenuSettingsText}"
                                                   VerticalAlignment="Center"
                                                   FontWeight="SemiBold" />
                                    </Grid>
                                </Button>

                                <Button Command="{Binding NavigateToUpdateCommand}" Classes="MenuBtn"
                                        IsEnabled="{Binding IsIdle}">
                                    <Grid ColumnDefinitions="60, *">
                                        <icons:MaterialIcon Grid.Column="0" Kind="CloudDownload" Width="24" Height="24"
                                                            HorizontalAlignment="Center" />
                                        <TextBlock Grid.Column="1" Text="{Binding MenuUpdateText}"
                                                   VerticalAlignment="Center"
                                                   FontWeight="SemiBold" />
                                    </Grid>
                                </Button>

                                <Button Command="{Binding NavigateToAboutCommand}" Classes="MenuBtn"
                                        IsEnabled="{Binding IsIdle}">
                                    <Grid ColumnDefinitions="60, *">
                                        <icons:MaterialIcon Grid.Column="0" Kind="InformationOutline" Width="24"
                                                            Height="24"
                                                            HorizontalAlignment="Center" />
                                        <TextBlock Grid.Column="1" Text="{Binding MenuAboutText}"
                                                   VerticalAlignment="Center"
                                                   FontWeight="SemiBold" />
                                    </Grid>
                                </Button>

                                <Button Command="{Binding NavigateToDeveloperCommand}" Classes="MenuBtn"
                                        IsEnabled="{Binding IsIdle}"
                                        IsVisible="{Binding SettingsVM.IsDeveloperModeEnabled}">
                                    <Grid ColumnDefinitions="60, *">
                                        <icons:MaterialIcon Grid.Column="0" Kind="Console" Width="24" Height="24"
                                                            HorizontalAlignment="Center" Foreground="#00FF00" />
                                        <TextBlock Grid.Column="1" Text="{Binding MenuDeveloperText}"
                                                   VerticalAlignment="Center"
                                                   FontWeight="SemiBold" Foreground="#00FF00" />
                                    </Grid>
                                </Button>

                            </StackPanel>
                        </ScrollViewer>

                        <Button Grid.Row="2" Command="{Binding ToggleThemeCommand}"
                                IsEnabled="{Binding SettingsVM.CanChangeTheme}"

                                Classes="MenuBtn">
                            <Grid ColumnDefinitions="60, *">
                                <icons:MaterialIcon Grid.Column="0" Kind="ThemeLightDark" Width="24" Height="24"
                                                    HorizontalAlignment="Center" />
                                <TextBlock Grid.Column="1" Text="{Binding MenuThemeText}" VerticalAlignment="Center" />
                            </Grid>
                        </Button>
                    </Grid>
                </Border>
            </SplitView.Pane>

            <SplitView.Content>
                <Border Padding="20" CornerRadius="12"
                        Background="{DynamicResource AppBackgroundBrush}"
                        Margin="0,40,25,25"
                        BorderBrush="{DynamicResource GlassBorderBrush}"
                        BorderThickness="1">
                    <ContentControl Content="{Binding CurrentPage}" />
                </Border>
            </SplitView.Content>
        </SplitView>
    </LayoutTransformControl>
</Window>